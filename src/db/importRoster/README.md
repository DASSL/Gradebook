README.md - Gradebook

Sean Murthy   
Data Science & Systems Lab (DASSL), Western Connecticut State University (WCSU)

(C) 2017- DASSL. ALL RIGHTS RESERVED.   
Licensed to others under CC 4.0 BY-SA-NC:   
https://creativecommons.org/licenses/by-nc-sa/4.0/

PROVIDED AS IS. NO WARRANTIES EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.


## Overview

The procedure to import a roster is designed to copy enrollment information
maintained in external systems to Gradebook. It is designed to provide the
following features:
- Add students automatically to the database, avoiding users from having to do
so explicitly.
- Not require a central administrator to import rosters. Instead, instructors
can themselves import rosters for the sections they teach.
- Support multi-user import so that different instructors can simultaneously
import rosters.
- Support importing rosters from different external systems: within the same
Gradebook installation, rosters from multiple external systems may be imported.

To support roster-import from disparate external systems, the procedure is split
into three steps:
1. Prepare the database for import, which includes creating a temporary staging
table.
2. Copy the external data to the staging table.
3. Process data in the staging table and insert rows to (or update rows in)
appropriate tables.


## Implementation

The code in this directory implements this procedure to import CSV rosters
generated by the [Elucian Banner](http://www.ellucian.com/student-information-system/)
system used at WCSU. However, the implementation could be customized to import
data in other formats or data from other systems.

The file `README.md` in directory `/tests/data` provides some information on
rosters generated by the Banner system. Directory `/tests/data/Roster` contains
some sample CSV rosters.

__Step1__: The script `prepareRosterImport.sql` implements the preparation step.
This script creates a temporary staging table named `RosterStaging`. It also
creates a temporary function `importRoster` that implements the process step
(Step 3).

__Step 2__: The `COPY` meta-command in [`psql`](https://www.postgresql.org/docs/9.6/static/app-psql.html)
is used to copy the contents of a CSV roster file to the staging table.

__Step 3__: The function `importRoster` is invoked to read the data in the
staging table, apply any necessary transformation, and add to or update the
tables `Student` and `Enrollee`.

## Running the import procedure

The import procedure implemented can be executed on a Microsoft Windows
system by running the batch command `importRosterCSV.bat`. This command accepts
a few parameters and uses the `psql` client to run all three steps of the import procedure:

To execute the procedure, open a Command window and run the batch command as shown
below. The strings shown after the command name are parameters; strings
shown inside brackets are optional parameters.

`importRosterCSV.bat csvFilePath year season courseNumber sectionNumber [dbUserName] [dbName] [server:port]`

The batch command accepts the following parameters:
- `csvFilePath`: The path to the file containing the CSV roster
- `year`: The year in which the section is taught (the section whose roster is
to be imported), for example, 2017.
- `season`: The "order", name, or code of the season in which the section is
taught, for example, 'Spring'. (See comments associated with the function `getSeason` for
details.)
- `courseNumber`: The course the section is about, for example, CS110.
- `sectionNumber`: The section number, for example, 72.
- The remaining parameters are passed to `psql` after being formatted according
to that program's need. These parameters are self explanatory.

Depending on the directory from which the batch command is run, the directory
containing the batch command and/or the directory containing the executable
`psql.exe` may need to be in the executable path.
